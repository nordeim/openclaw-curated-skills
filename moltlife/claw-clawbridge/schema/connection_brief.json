{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://clawbridge.dev/schemas/connection_brief.json",
  "title": "Connection Brief",
  "description": "Structured output from a clawbridge scouting run",
  "type": "object",
  "required": ["workspace_id", "run_id", "project_profile_hash", "candidates", "next_actions"],
  "properties": {
    "workspace_id": {
      "type": "string",
      "pattern": "^ws_[a-zA-Z0-9]+$",
      "description": "Unique identifier for the workspace (agency/project)"
    },
    "run_id": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of when the run was executed"
    },
    "project_profile_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA256 hash of the project profile used for this run"
    },
    "run_metadata": {
      "type": "object",
      "properties": {
        "duration_seconds": {
          "type": "number",
          "description": "Total run duration in seconds"
        },
        "searches_performed": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of web searches executed"
        },
        "pages_fetched": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of pages fetched for analysis"
        },
        "candidates_evaluated": {
          "type": "integer",
          "minimum": 0,
          "description": "Total candidates evaluated before filtering"
        },
        "skill_version": {
          "type": "string",
          "description": "Version of claw-clawbridge skill used"
        }
      }
    },
    "candidates": {
      "type": "array",
      "minItems": 0,
      "maxItems": 10,
      "description": "Top K ranked candidates for connection",
      "items": {
        "type": "object",
        "required": ["name", "why_match", "evidence_urls", "suggested_intro"],
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1,
            "description": "Full name of the candidate"
          },
          "handle": {
            "type": "string",
            "description": "Social media handle or username (e.g., @username)"
          },
          "role": {
            "type": "string",
            "description": "Job title or role"
          },
          "company": {
            "type": "string",
            "description": "Company or organization name"
          },
          "email": {
            "type": "string",
            "format": "email",
            "description": "Email address if publicly available"
          },
          "why_match": {
            "type": "array",
            "minItems": 1,
            "maxItems": 5,
            "items": {
              "type": "string"
            },
            "description": "Reasons why this candidate matches the project ask"
          },
          "evidence_urls": {
            "type": "array",
            "minItems": 2,
            "items": {
              "type": "string",
              "format": "uri"
            },
            "description": "URLs supporting this candidate's relevance"
          },
          "risk_flags": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": [
                "low_evidence",
                "spammy_language",
                "unclear_identity",
                "too_salesy",
                "irrelevant",
                "stale_activity"
              ]
            },
            "description": "Risk indicators for this candidate"
          },
          "scores": {
            "type": "object",
            "properties": {
              "relevance": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "intent": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "credibility": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "recency": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "engagement": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "final_score": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              }
            },
            "description": "Scoring breakdown for ranking"
          },
          "last_activity": {
            "type": "string",
            "format": "date",
            "description": "Date of most recent activity detected"
          },
          "suggested_intro": {
            "type": "string",
            "minLength": 50,
            "maxLength": 1000,
            "description": "Draft introduction message"
          },
          "suggested_followup": {
            "type": "string",
            "maxLength": 500,
            "description": "Draft follow-up message"
          }
        }
      }
    },
    "next_actions": {
      "type": "array",
      "description": "Suggested next steps for each candidate",
      "items": {
        "type": "object",
        "required": ["candidate_handle", "action", "reason"],
        "properties": {
          "candidate_handle": {
            "type": "string",
            "description": "Handle of the candidate this action is for"
          },
          "action": {
            "type": "string",
            "enum": [
              "reach_out",
              "research_more",
              "warm_intro_via",
              "wait_for_trigger",
              "skip"
            ],
            "description": "Recommended action type"
          },
          "reason": {
            "type": "string",
            "description": "Explanation for why this action is recommended"
          },
          "via": {
            "type": "string",
            "description": "Platform or person to use for warm intro if applicable"
          },
          "priority": {
            "type": "string",
            "enum": ["high", "medium", "low"],
            "description": "Priority level for this action"
          }
        }
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "headline": {
          "type": "string",
          "maxLength": 100,
          "description": "One-line summary of the run results"
        },
        "key_insights": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Key observations from this run"
        },
        "venues_searched": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of venues that were searched"
        }
      }
    }
  },
  "additionalProperties": false
}
