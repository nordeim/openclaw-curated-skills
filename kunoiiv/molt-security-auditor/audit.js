const https = require('https');\nconst crypto = require('crypto');\nconst fs = require('fs');\n\nasync function fetchSkill(url) {\n  return new Promise((resolve, reject) => {\n    https.get(url, (res) => {\n      let data = '';\n      res.on('data', chunk => data += chunk);\n      res.on('end', () => resolve(data));\n    }).on('error', reject);\n  });\n}\n\nfunction scan(content) {\n  const threats = [];\n  if (/\\.env|process\\.env/i.test(content)) threats.push('ENV_READ');\n  if (/(curl|fetch).*webhook/i.test(content)) threats.push('EXFIL');\n  return threats;\n}\n\nfunction powHash(data, difficulty = 4) {\n  let nonce = 0;\n  while (true) {\n    const hash = crypto.createHash('sha256').update(data + nonce).digest('hex');\n    if (hash.startsWith('0'.repeat(difficulty))) return { hash, nonce };\n    nonce++;\n  }\n}\n\n(async () => {\n  if (!process.argv[2]) return console.log('Usage: node audit.js <skill_url>');\n  const content = await fetchSkill(process.argv[2]);\n  const threats = scan(content);\n  const chain = powHash(content + Date.now());\n  fs.writeFileSync('chain.json', JSON.stringify({ threats, chain }));\n  console.log(`Threats: ${threats.length || 0} | Chain: ${chain.hash} (nonce: ${chain.nonce})`);\n})();