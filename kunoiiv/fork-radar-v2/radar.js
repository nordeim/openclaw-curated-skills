const https = require('https');\nconst crypto = require('crypto');\nconst fs = require('fs');\n\nasync function githubApi(path) {\n  return new Promise((resolve, reject) => {\n    https.get(`https://api.github.com/repos/${path}/forks?per_page=10`, {headers: {'User-Agent': 'ForkRadar'}}, (res) => {\n      let data = '';\n      res.on('data', chunk => data += chunk);\n      res.on('end', () => resolve(JSON.parse(data)));\n    }).on('error', reject);\n  });\n}\n\nasync function fetchSkill(repoUrl) {\n  const url = repoUrl.replace('github.com', 'raw.githubusercontent.com').replace('/tree/main', '') + '/SKILL.md';\n  return new Promise((resolve, reject) => {\n    https.get(url, (res) => {\n      let data = '';\n      res.on('data', chunk => data += chunk);\n      res.on('end', () => resolve(data));\n    }).on('error', reject);\n  });\n}\n\nfunction scanThreats(content) {\n  const threats = [];\n  if (/\\.env|process\\.env/i.test(content)) threats.push('ENV_READ');\n  if (/(curl|fetch).*webhook/i.test(content)) threats.push('EXFIL');\n  return threats;\n}\n\nfunction powVerify(content, expectedHash) {\n  const hash = crypto.createHash('sha256').update(content).digest('hex');\n  return hash === expectedHash; // Simplified\n}\n\nasync function radar(repoSlug) {\n  console.log(`Scanning forks of ${repoSlug}...`);\n  const forks = await githubApi(repoSlug);\n  const alerts = [];\n  for (const fork of forks.slice(0,5)) {\n    try {\n      const content = await fetchSkill(fork.full_name);\n      const threats = scanThreats(content);\n      const score = fork.stargazers_count - threats.length * 10;\n      if (threats.length > 0) alerts.push(`Threat in ${fork.full_name}: ${threats.join(', ')}`);\n      if (score > 5) alerts.push(`Collab fork: ${fork.full_name} (score: ${score})`);\n    } catch (e) {\n      alerts.push(`Error scanning ${fork.full_name}: ${e.message}`);\n    }\n  }\n  fs.writeFileSync('radar.json', JSON.stringify({repo: repoSlug, alerts}));\n  console.log('Alerts:', alerts);\n  console.log('Saved: radar.json');\n}\n\nif (process.argv[2]) radar(process.argv[2]);\nelse console.log('Usage: node radar.js <repo_slug>');