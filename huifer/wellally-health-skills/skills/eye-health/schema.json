{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://wellallyhealth.com/schemas/eye-health.json",
  "title": "EyeHealthTracker",
  "description": "眼健康追踪的数据结构定义",
  "type": "object",
  "properties": {
    "vision_records": {
      "type": "array",
      "description": "视力检查记录",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "date": { "type": "string", "format": "date" },
          "left_eye": {
            "type": "object",
            "properties": {
              "uncorrected_va": { "type": "number", "minimum": 0, "maximum": 2 },
              "corrected_va": { "type": "number", "minimum": 0, "maximum": 2 },
              "sphere": { "type": "number", "minimum": -20, "maximum": 20 },
              "cylinder": { "type": "number", "minimum": -6, "maximum": 0 },
              "axis": { "type": "number", "minimum": 0, "maximum": 180 }
            }
          },
          "right_eye": {
            "type": "object",
            "properties": {
              "uncorrected_va": { "type": "number" },
              "corrected_va": { "type": "number" },
              "sphere": { "type": "number" },
              "cylinder": { "type": "number" },
              "axis": { "type": "number" }
            }
          },
          "exam_type": { "type": "string" },
          "notes": { "type": "string" },
          "created_at": { "type": "string", "format": "date-time" }
        }
      }
    },
    "iop_records": {
      "type": "array",
      "description": "眼压记录",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "date": { "type": "string", "format": "date" },
          "time": { "type": "string", "pattern": "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$" },
          "left_iop": { "type": "number", "minimum": 5, "maximum": 50 },
          "right_iop": { "type": "number", "minimum": 5, "maximum": 50 },
          "measurement_method": { "type": "string" },
          "reference_range": { "type": "string" },
          "notes": { "type": "string" }
        }
      }
    },
    "fundus_exams": {
      "type": "array",
      "description": "眼底检查记录",
      "items": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "date": { "type": "string", "format": "date" },
          "exam_type": { "type": "string" },
          "findings": {
            "type": "object",
            "properties": {
              "left_eye": { "type": "string" },
              "right_eye": { "type": "string" },
              "overall": { "type": "string" }
            }
          },
          "comments": { "type": "string" }
        }
      }
    },
    "screening_records": {
      "type": "object",
      "description": "眼病筛查记录",
      "properties": {
        "glaucoma": {
          "type": "object",
          "properties": {
            "last_screened": { "type": "string", "format": "date" },
            "result": { "type": "string", "enum": ["negative", "suspect", "early", "moderate", "advanced"] },
            "next_screening": { "type": "string", "format": "date" }
          }
        },
        "cataract": {
          "type": "object",
          "properties": {
            "last_screened": { "type": "string", "format": "date" },
            "result": { "type": "string", "enum": ["none", "grade_1", "grade_2", "grade_3", "mature"] }
          }
        },
        "amd": {
          "type": "object",
          "properties": {
            "last_screened": { "type": "string", "format": "date" },
            "result": { "type": "string", "enum": ["none", "early", "intermediate", "late"] }
          }
        },
        "diabetic_retinopathy": {
          "type": "object",
          "properties": {
            "last_screened": { "type": "string", "format": "date" },
            "result": { "type": "string", "enum": ["none", "mild", "moderate", "severe", "proliferative"] }
          }
        },
        "dry_eye": {
          "type": "object",
          "properties": {
            "last_screened": { "type": "string", "format": "date" },
            "result": { "type": "string", "enum": ["none", "mild", "moderate", "severe"] }
          }
        }
      }
    },
    "habit_records": {
      "type": "array",
      "description": "用眼习惯记录",
      "items": {
        "type": "object",
        "properties": {
          "date": { "type": "string", "format": "date" },
          "screen_time_hours": { "type": "number", "minimum": 0 },
          "outdoor_time_hours": { "type": "number", "minimum": 0 },
          "break_20_20_20": { "type": "string", "enum": ["yes", "no", "partial"] },
          "viewing_distance_cm": { "type": "number" },
          "lighting": { "type": "string", "enum": ["good", "adequate", "poor"] }
        }
      }
    },
    "checkup_reminders": {
      "type": "object",
      "description": "检查提醒",
      "properties": {
        "routine_checkup": { "type": "string", "format": "date" },
        "glaucoma_screening": { "type": "string", "format": "date" },
        "diabetic_eye_exam": { "type": "string", "format": "date" }
      }
    }
  }
}
