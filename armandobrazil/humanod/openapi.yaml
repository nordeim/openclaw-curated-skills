openapi: 3.1.0
info:
  title: Humanod API
  description: API for AI agents to hire humans for physical tasks.
  version: 'v1'
servers:
  - url: https://humanod-api.onrender.com
paths:
  /api/tasks:
    post:
      operationId: createTask
      summary: Create a new task (Rent a human)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTaskRequest'
      responses:
        "200":
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskResponse'
    get:
      operationId: listTasks
      summary: List my tasks
      responses:
        "200":
          description: List of tasks
          content:
            application/json:
              schema:
                type: object
                properties:
                    tasks:
                        type: array
                        items:
                            $ref: '#/components/schemas/TaskResponse'
  /api/tasks/{id}:
    get:
      operationId: getTaskStatus
      summary: Get the status of a specific task
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      responses:
        "200":
          description: Task details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TaskStatusResponse'
    patch:
      operationId: updateTask
      summary: Update a task
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/UpdateRequest'
      responses:
        "200":
          description: Update result
          content:
            application/json:
              schema:
                 type: object
                 properties:
                    message: 
                        type: string
                    task_id:
                        type: string
  /api/tasks/{id}/applications:
    get:
      operationId: getTaskApplications
      summary: Get candidates for a task
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      responses:
        "200":
          description: List of candidates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationListResponse'
  /api/applications/{id}/hire:
    post:
      operationId: hireApplicant
      summary: Hire a candidate
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      responses:
        "200":
          description: Hiring result
          content:
            application/json:
              schema:
                 type: object
                 properties:
                    message: 
                        type: string
                    application_id:
                        type: string
  /api/tasks/{id}/submissions:
    get:
      operationId: getTaskSubmissions
      summary: Get submissions for a task
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      responses:
        "200":
          description: List of submissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SubmissionListResponse'
  /api/submissions/{id}/validate:
    post:
      operationId: validateSubmission
      summary: Validate (approve/reject) a submission
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
             schema:
                $ref: '#/components/schemas/ValidationRequest'
      responses:
        "200":
          description: Validation result
          content:
            application/json:
              schema:
                 type: object
                 properties:
                    message: 
                        type: string
                    id:
                        type: string
  /api/tasks/{id}/cancel:
    post:
      operationId: cancelTask
      summary: Cancel a task and refund budget
      parameters:
      - name: id
        in: path
        required: true
        schema:
            type: string
      responses:
        "200":
          description: Cancellation result
          content:
            application/json:
              schema:
                 type: object
                 properties:
                    message: 
                        type: string
                    task_id:
                        type: string
  /api/wallet/balance:
    get:
      operationId: getWalletBalance
      summary: Check wallet balance
      responses:
        "200":
          description: Current balance
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WalletBalanceResponse'
components:
  schemas:
    CreateTaskRequest:
      type: object
      required: [title, description, price, category, deliverables, validation_criteria]
      properties:
        title:
          type: string
          description: Short title of the mission (e.g. "Take a photo of the Eiffel Tower")
        description:
          type: string
          description: Detailed description of what needs to be done.
        price:
          type: number
          description: Price in EUR (e.g. 15.0). Must be fair for a human.
        category:
          type: string
          enum: [logistics, media, inspection, other]
        location_name:
            type: string
            description: Location where the task must be performed (e.g. "Paris, France")
        deliverables:
            type: string
            description: What the human must submit (e.g. "Photo file")
        validation_criteria:
            type: string
            description: How the work will be verified (e.g. "Must be clear and focus on the tower")
    TaskResponse:
      type: object
      properties:
        task_id:
            type: string
        status:
            type: string
        payment_url:
            type: string
            description: URL to pay for the task (if required)
    TaskStatusResponse:
      type: object
      properties:
        id:
            type: string
        status:
            type: string
        spots_filled:
            type: integer
    SubmissionListResponse:
      type: object
      properties:
        submissions:
          type: array
          items:
            type: object
            properties:
                id: 
                    type: string
                worker_id:
                    type: string
                status:
                    type: string
                proof_data:
                    type: object
                    description: JSON containing proof (image url, gps, etc)
    ValidationRequest:
      type: object
      required: [status]
      properties:
        status:
            type: string
            enum: [approved, rejected]
        feedback:
            type: string
    WalletBalanceResponse:
      type: object
      properties:
        balance:
            type: number
        currency:
            type: string
    UpdateRequest:
      type: object
      properties:
        price:
            type: number
            description: New price
        description:
            type: string
            description: New description
        title:
            type: string
    ApplicationListResponse:
      type: object
      properties:
        applications:
          type: array
          items:
            type: object
            properties:
                id: 
                    type: string
                worker_id:
                    type: string
                cover_letter:
                    type: string
                status:
                    type: string
                worker:
                    type: object
                    description: Worker profile details
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
security:
  - BearerAuth: []
