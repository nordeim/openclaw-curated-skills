openapi: 3.0.0
info:
  title: Pancake API Library
  version: 1.0.0
  description: >
    API for retrieving page data, generating access tokens, and listing conversations on Pancake platform.
  contact:
    name: Pancake Support
    url: 'https://www.pancake.biz/contact'

servers:
  - url: 'https://pages.fm/api/v1'
    description: User's API
  - url: 'https://pages.fm/api/public_api/v1'
    description: Page's API v1
  - url: 'https://pages.fm/api/public_api/v2'
    description: Page's API v2

tags:
  - name: Pages
    description: Page management and access tokens
  - name: Conversations
    description: Customer conversations
  - name: Messages
    description: Operations related to chat messages
  - name: Statistics
    description: Advertising campaign and ad report statistics APIs
  - name: Statistics - User
    description: APIs related to user (staff) performance statistics across single or multiple pages

paths:
  /pages:
    get:
      servers:
        - url: 'https://pages.fm/api/v1'
          description: User's API (default for list pages)
      tags:
        - Pages
      summary: List pages
      description: Get list pages for the authenticated account
      security:
        - UserAccessToken: []
      parameters:
        - name: access_token
          in: query
          required: true
          schema:
            type: string
          description: Pancake user access token for authentication.
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  pages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Page'

  /pages/{page_id}/generate_page_access_token:
    post:
      servers:
        - url: 'https://pages.fm/api/v1'
          description: User's API (default for list pages)
      tags:
        - Pages
      summary: Generate page_access_token
      description: "Generate or refresh page_access_token by the admin's access_token of page. Page Access Token used to authenticate public APIs on behalf of a Page. The page's admin can retrieve this token from the Pancake interface by going to: Page's settings → Tools. This token does not expire unless it is manually deleted or renewed. An API key is a token that you provide when making API calls. Include the token in a query parameter called page_access_token."
      security:
        - UserAccessToken: []
      parameters:
        - name: page_id
          in: query
          required: true
          schema:
            type: string
          description: ID of the customer's page.
        - name: access_token
          in: query
          required: true
          schema:
            type: string
          description: Pancake user access token with admin rights to the page.
      responses:
        '200':
          description: Token generated successfully

  /pages/{page_id}/conversations:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v2'
          description: Page's API v2
      tags:
        - Conversations
      summary: Conversations
      description: Get a list of the latest 60 conversations. Put the `last_conversation_id` parameter to get more conversations.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token of the page for authentication.
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: Unique ID of the customer's page.
        - name: last_conversation_id
          in: query
          required: false
          schema:
            type: string
          description: "The `last_conversation_id` parameter represents the ID of a conversation. If this parameter is not provided, the system returns the 60 most recently updated conversations. If you provide the ID of the last conversation from the previous call, the system returns the next 60 older conversations."
        - name: tags
          in: query
          required: false
          schema:
            type: string
          description: Filter conversations by tag IDs (comma-separated).
        - name: type
          in: query
          required: false
          schema:
            type: array
            items:
              type: string
          description: Filter by conversation types (e.g. INBOX, COMMENT).
        - name: post_ids
          in: query
          required: false
          schema:
            type: array
            items:
              type: string
          description: Filter by post IDs (for comment-based conversations).
        - name: since
          in: query
          required: false
          schema:
            type: integer
          description: Filter from a specific timestamp (in seconds).
        - name: until
          in: query
          required: false
          schema:
            type: integer
          description: Filter up to a specific timestamp (in seconds).
        - name: unread_first
          in: query
          required: false
          schema:
            type: boolean
          description: Prioritize unread conversations.
        - name: order_by
          in: query
          required: false
          schema:
            type: string
            enum: [inserted_at, updated_at]
          description: Sort by insertion or update time.
      responses:
        '200':
          description: List of conversations
          content:
            application/json:
              schema:
                type: object
                properties:
                  conversations:
                    type: array
                    items:
                      $ref: '#/components/schemas/Conversation'

  /pages/{page_id}/conversations/{conversation_id}/tags:
    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Conversations
      summary: Conversation's tag
      description: Add or remove a tag from a conversation
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: Unique ID of the customer's page.
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: Unique ID of the conversation to be updated.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token of the page used for authentication.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - action
                - tag_id
              properties:
                action:
                  type: string
                  enum: [add, remove]
                  description: Action to perform (add or remove tag)
                tag_id:
                  type: string
                  description: ID of the tag to be added or removed.
      responses:
        '200':
          description: Tags updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: integer
                    description: List of tag IDs after update
                  success:
                    type: boolean
                  timestamp:
                    type: integer
                    description: Operation timestamp
  # Assign staff to a conversation
  /pages/{page_id}/conversations/{conversation_id}/assign:
    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Conversations
      summary: Assign conversation
      description: Assign one or more staff members to a specific conversation
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: Unique ID of the customer's page.
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: Unique ID of the conversation to assign staff to.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token of the page used for authentication.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - assignee_ids
              properties:
                assignee_ids:
                  type: array
                  description: List of user IDs to assign to the conversation
                  items:
                    type: string
      responses:
        '200':
          description: Conversation assigned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  assignee_group_id:
                    type: string
                  assignee_ids:
                    type: array
                    items:
                      type: string
                  customers:
                    type: array
                    items:
                      type: object
                      properties:
                        fb_id:
                          type: string
                        id:
                          type: string
                        name:
                          type: string
                  from:
                    type: object
                    properties:
                      email:
                        type: string
                      id:
                        type: string
                      name:
                        type: string
                  seen:
                    type: boolean
                  updated_at:
                    type: string
                    format: date-time

  # Mark a conversation as read
  /pages/{page_id}/conversations/{conversation_id}/read:
    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Conversations
      summary: Mark conversation as read
      description: Mark a conversation as read
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer's page
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the conversation
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token
      responses:
        '200':
          description: Success response
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean

  # Mark a conversation as unread
  /pages/{page_id}/conversations/{conversation_id}/unread:
    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Conversations
      summary: Mark conversation as unread
      description: Mark a conversation as unread
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer's page
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the conversation
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token
      responses:
        '200':
          description: Success response
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean

  # Retrieve message history from a conversation
  /pages/{page_id}/conversations/{conversation_id}/messages:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Messages
      summary: Get messages
      description: Retrieve the list of messages in a conversation. Put the `current_count` parameter to get more messages.
      security:
        - PageAccessToken: []
      parameters:
        - name: current_count
          in: query
          required: false
          schema:
            type: number
          description: Index position to retrieve messages from. Returns 30 messages prior to this index.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the conversation to get messages from
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page to retrieve data from
      responses:
        '200':
          description: List of messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    items:
                      type: object
                      properties:
                        conversation_id:
                          type: string
                        from:
                          type: object
                          properties:
                            email:
                              type: string
                            id:
                              type: string
                            name:
                              type: string
                        has_phone:
                          type: boolean
                        inserted_at:
                          type: string
                        is_hidden:
                          type: boolean
                        is_removed:
                          type: boolean
                        message:
                          type: string
                        page_id:
                          type: string
                        type:
                          type: string

    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Messages
      summary: Send a message (private reply, inbox, or comment reply)
      description: >
        Send different types of messages to customers:

        - **Inbox Message**: Send normal inbox message. Use **either** `message` **OR** `content_ids` (mutually exclusive).
        
        - **Reply Comment**: reply to a customer's comment        

        - **Private Reply**: send a private reply from a customer's comment (only apply for some platforms like Facebook, Instagram). 

        ⚠️ **IMPORTANT**: `message` and `content_ids` are **MUTUALLY EXCLUSIVE**. Do **NOT** send both simultaneously or API returns error.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of your page. You can take it from [the get list pages API](https://developer.pancake.biz/#/paths/pages/get)
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the conversation. You can take it from [the get conversations API](https://developer.pancake.biz/#/paths/pages-page_id--conversations/get)
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (generate in tool settings)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/InboxMessage'
                - $ref: '#/components/schemas/ReplyComment'
                - $ref: '#/components/schemas/PrivateReply'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  id:
                    type: string
                  message:
                    type: string


#Statistic
  /pages/{page_id}/statistics/pages_campaigns:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: Ads campaign
      description: Retrieve campaign-level statistics for a specific Facebook Page.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page to retrieve data for.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (requires permission to view ad reports).
        - name: since
          in: query
          required: true
          schema:
            type: integer
          description: Start time in Unix timestamp (UTC+0).
        - name: until
          in: query
          required: true
          schema:
            type: integer
          description: End time in Unix timestamp (UTC+0).
      responses:
        '200':
          description: Successful campaign stats response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    account_id:
                      type: string
                    ad_id:
                      type: string
                    adset_id:
                      type: string
                    budget_remaining:
                      type: string
                    currency:
                      type: string
                    daily_budget:
                      type: string
                    status:
                      type: string

  /pages/{page_id}/statistics/ads:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: Ads
      description: Retrieve ad-level statistics with options by time or by ID.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token
        - name: since
          in: query
          required: true
          schema:
            type: integer
          description: Start time (Unix timestamp)
        - name: until
          in: query
          required: true
          schema:
            type: integer
          description: End time (Unix timestamp)
        - name: type
          in: query
          required: true
          schema:
            type: string
          description: Type of aggregation, one of `by_id` or `by_time`
      responses:
        '200':
          description: Successful ad stats response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                    status:
                      type: string
                    currency:
                      type: string
                    reach:
                      type: string
                    impressions:
                      type: string
                    spend:
                      type: string
  /pages/{page_id}/statistics/customer_engagements:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: Engagement
      description: Retrieve engagement statistics for a given page by date range or hour.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page to retrieve engagement statistics for.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (requires permission to view reports).
        - name: date_range
          in: query
          required: true
          schema:
            type: string
          description: Date range for the report (e.g., 27/07/2021 00:00:00 - 26/08/2021 23:59:59)
        - name: by_hour
          in: query
          required: false
          schema:
            type: boolean
          description: Whether to return data aggregated by hour.
        - name: user_ids
          in: query
          required: false
          schema:
            type: string
          description: Comma-separated list of staff user IDs to filter results. Refer to user list API.
      responses:
        '200':
          description: Engagement statistics data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      categories:
                        type: array
                        items:
                          type: string
                        description: List of date labels (e.g., "26/8", formatted according to the selected date range and timezone)
                      series:
                        type: array
                        description: Statistical data series corresponding to each category (date label), where each series represents a specific metric (e.g., inbox, comment, total).
                        items:
                          type: object
                          properties:
                            name:
                              type: string
                              description: Metric type (e.g., inbox, comment, total, new_customer_replied)
                            data:
                              type: array
                              items:
                                type: integer
                  statistics:
                    type: array
                    description: Read more detail [Document](https://pke.gg/zlr63yl8)
                    items:
                      type: object
                      properties:
                        hour:
                          type: string
                          format: date-time
                          description: Statistics timestamp, aggregated by hour
                        inbox:
                          type: integer
                          description: Total number of customer engagements via inbox messages (including both new and existing customers). Each customer is counted once per day.
                        comment:
                          type: integer
                          description: Total number of customer engagements via comment messages (including both new and existing customers). Each customer is counted once per day.
                        total:
                          type: integer
                          description: Total number of customer engagements via all message channels (inbox and comments combined). Each customer is counted once per day.
                        new_customer:
                          type: integer
                          description: Number of engagements with new customers (customers who have not previously interacted with the page), including both messages and comments.
                        new_customer_from_inbox:
                          type: integer
                          description: Number of customers who initiated new inbox conversations. Customers are still counted even if they previously interacted via comments.

  /pages/{page_id}/statistics/pages:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: Page
      description: Retrieve general page statistics over time.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (requires permission)
        - name: since
          in: query
          required: true
          schema:
            type: integer
          description: Start time in Unix timestamp (UTC+0)
        - name: until
          in: query
          required: true
          schema:
            type: integer
          description: End time in Unix timestamp (UTC+0)
      responses:
        '200':
          description: Page statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        customer_comment_count:
                          type: integer
                        customer_inbox_count:
                          type: integer
                        hour:
                          type: string
                          format: date-time
                        inbox_interactive_count:
                          type: integer
                        new_customer_count:
                          type: integer
                        new_inbox_count:
                          type: integer
                        page_comment_count:
                          type: integer
                        page_inbox_count:
                          type: integer
                        phone_number_count:
                          type: integer
                        today_uniq_website_referral:
                          type: integer
                        today_website_guest_referral:
                          type: integer
                        uniq_phone_number_count:
                          type: integer

  /pages/{page_id}/statistics/tags:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: Tag
      description: Retrieve tag usage statistics over a specified time range.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token
        - name: since
          in: query
          required: true
          schema:
            type: integer
          description: Start time (Unix timestamp, UTC+0)
        - name: until
          in: query
          required: true
          schema:
            type: integer
          description: End time (Unix timestamp, UTC+0)
      responses:
        '200':
          description: Tag statistics by time range and today summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    type: object
                    properties:
                      categories:
                        type: array
                        items:
                          type: string
                      series:
                        type: object
                        additionalProperties:
                          type: array
                          items:
                            type: integer
                  data_today:
                    type: object
                    properties:
                      categories:
                        type: array
                        items:
                          type: string
                      series:
                        type: object
                        additionalProperties:
                          type: array
                          items:
                            type: integer
                  tags:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        text:
                          type: string
                        color:
                          type: string
                        lighten_color:
                          type: string
                        description:
                          type: string
                          nullable: true

  /pages/{page_id}/statistics/users:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: User
      description: >
        Retrieve detailed interaction statistics for users (staff) of a specific page within a given date range.
        Includes message count, comment count, average response time, and more.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page to retrieve statistics for.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token for the page (generated in the page's tool settings).
        - name: date_range
          in: query
          required: true
          schema:
            type: string
            example: "27/07/2021 00:00:00 - 26/08/2021 23:59:59"
          description: Date range for statistics collection.
      responses:
        '200':
          description: Successful response with user statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      statistics:
                        type: object
                        additionalProperties:
                          type: array
                          items:
                            type: object
                            properties:
                              average_response_time:
                                type: integer
                                description: Average response time in milliseconds
                                example: 74276
                              comment_count:
                                type: integer
                                description: Total comment count handled
                                example: 0
                              inbox_count:
                                type: integer
                                description: Total inbox messages handled
                                example: 6
                              phone_number_count:
                                type: integer
                                description: Phone numbers collected
                                example: 0
                              private_reply_count:
                                type: integer
                                description: Number of private replies sent from comments
                                example: 0
                              unique_comment_count:
                                type: integer
                                description: Number of unique customer comments responded to
                                example: 0
                              unique_inbox_count:
                                type: integer
                                description: Number of unique inbox conversations responded to
                                example: 2
                              hour:
                                type: string
                                format: date-time
                                description: Time bucket for statistics
                                example: "2021-07-28T10:00:00"
                      users:
                        type: object
                        additionalProperties:
                          type: object
                          properties:
                            user_name:
                              type: string
                              example: "Quyết Nguyễn"
                            user_fb_id:
                              type: string
                              example: "570423649807405"
                            average_response_time:
                              type: integer
                              example: 588569
                            comment_count:
                              type: integer
                              example: 0
                            inbox_count:
                              type: integer
                              example: 637
                            phone_number_count:
                              type: integer
                              example: 0
                            private_reply_count:
                              type: integer
                              example: 0
                            unique_comment_count:
                              type: integer
                              example: 0
                            unique_inbox_count:
                              type: integer
                              example: 30
                            hour:
                              type: string
                              format: date-time
                              example: "2021-08-26T13:00:00"

  /pages/{page_id}/page_customers:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Statistics
      summary: New customer
      description: >
        Retrieve statistics for new customers over a specified period of time. 
        You can group data by day (default), hour, or page ID.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page to retrieve customer statistics for.
        - name: group_by
          in: query
          required: false
          schema:
            type: string
            enum: [day, hour, page_id]
            default: day
          description: >
            Grouping method for the data:
            - `day`: Returns data grouped by day (default).
            - `hour`: Returns data grouped by hour.
            - `page_id`: Returns data grouped by page ID.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token for the page (retrievable from page settings).
        - name: date_range
          in: query
          required: true
          schema:
            type: string
            example: "20/07/2020 - 20/08/2020"
          description: The date range for which to retrieve statistics.
      responses:
        '200':
          description: Successful response with new customer statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    oneOf:
                      - type: array
                        description: Statistics grouped by day or hour
                        items:
                          type: object
                          properties:
                            date:
                              type: string
                              description: Date or hour of the statistics
                              example: "2020-08-12T16:00:00"
                            new_customer_count:
                              type: integer
                              description: Number of new customers
                              example: 4
                            new_page_inbox_count:
                              type: integer
                              description: Number of new inbox conversations
                              example: 3
                            new_phone_number_count:
                              type: integer
                              description: Number of new phone numbers collected
                              example: 0
                            phone_number_count:
                              type: integer
                              description: Total phone numbers
                              example: 0
                      - type: object
                        description: Statistics grouped by page ID
                        additionalProperties:
                          type: array
                          items:
                            type: object
                            properties:
                              date:
                                type: string
                                description: Date of the statistics
                                example: "2020-08-12"
                              new_customer_count:
                                type: integer
                                example: 0
                              new_page_inbox_count:
                                type: integer
                                example: 1
                              new_phone_number_count:
                                type: integer
                                example: 0
                              phone_number_count:
                                type: integer
                                example: 0
                  success:
                    type: boolean
                    example: true
              
  /pages/{page_id}/export_data:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Export Data
      summary: Export conversations from ads
      description: >
        Export conversations coming from ads within a specified time range. 
        Each request returns up to 60 conversations starting from the given offset.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer page.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Access token of the page (retrievable from page settings).
        - name: since
          in: query
          required: true
          schema:
            type: integer
            format: int64
            example: 1672531200
          description: Start time in UNIX timestamp (UTC+0).
        - name: until
          in: query
          required: true
          schema:
            type: integer
            format: int64
            example: 1675219599
          description: End time in UNIX timestamp (UTC+0).
        - name: action
          in: query
          required: true
          schema:
            type: string
            enum: [conversations_from_ads]
          description: Action type, must be `conversations_from_ads`.
        - name: offset
          in: query
          required: false
          schema:
            type: integer
            default: 0
          description: >
            Offset for pagination. Default is 0. Each call returns up to 60 records.
      responses:
        '200':
          description: Successfully exported conversations
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    description: List of conversations
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: Conversation ID
                        tags:
                          type: array
                          items:
                            type: string
                        from:
                          type: object
                          properties:
                            email:
                              type: string
                              example: "user@example.com"
                            id:
                              type: string
                              description: Facebook user ID
                            name:
                              type: string
                              description: Name of the user
                        inserted_at:
                          type: string
                          format: date-time
                        updated_at:
                          type: string
                          format: date-time
                        customers:
                          type: array
                          items:
                            type: object
                            properties:
                              fb_id:
                                type: string
                              id:
                                type: string
                              name:
                                type: string
                        recent_phone_numbers:
                          type: array
                          items:
                            type: string
                        recent_seen_users:
                          type: array
                          items:
                            type: object
                            properties:
                              fb_id:
                                type: string
                              fb_name:
                                type: string
                              seen_at:
                                type: string
                                format: date-time
                        thread_key:
                          type: string
                        psid:
                          type: string
                        ad_clicks:
                          type: array
                          items:
                            type: string
                        is_banned:
                          type: boolean
                        assignees:
                          type: array
                          items:
                            type: object
                            properties:
                              id:
                                type: string
                              name:
                                type: string
                  success:
                    type: boolean
                    example: true

  /pages/{page_id}/page_customers:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Customers
      summary: Get page customers information
      description: >
        Retrieve customer information for a specific page within a time range. Supports pagination and sorting options.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: The ID of the customer page.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: The access token of the page (can be created in the page settings).
        - name: since
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: Start time in UNIX timestamp (UTC+0).
        - name: until
          in: query
          required: true
          schema:
            type: integer
            format: int64
          description: End time in UNIX timestamp (UTC+0).
        - name: page_number
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
          description: Current page number (minimum value: 1).
        - name: page_size
          in: query
          required: false
          schema:
            type: integer
            maximum: 100
          description: The size of each page (maximum 100).
        - name: order_by
          in: query
          required: false
          schema:
            type: string
            enum: [inserted_at, updated_at]
            default: inserted_at
          description: Sort order in descending order. Options: `inserted_at` (creation time), `updated_at` (last updated time).
      responses:
        '200':
          description: Successfully retrieved customers information
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                    description: Total number of customers
                    example: 500
                  customers:
                    type: array
                    description: List of customers
                    items:
                      type: object
                      properties:
                        birthday:
                          type: string
                          format: date
                          nullable: true
                          description: Customer's birthday
                        gender:
                          type: string
                          nullable: true
                          description: Customer's gender
                        inserted_at:
                          type: string
                          format: date-time
                          description: Creation time of the customer record
                        lives_in:
                          type: string
                          nullable: true
                          description: Customer's location
                        name:
                          type: string
                          description: Customer's name
                        phone_numbers:
                          type: array
                          items:
                            type: string
                          description: List of phone numbers
                        psid:
                          type: string
                          description: Page-scoped user ID
                        notes:
                          type: array
                          description: Customer notes
                          items:
                            type: object
                            properties:
                              created_at:
                                type: integer
                                format: int64
                                description: Creation time in UNIX timestamp (milliseconds)
                              created_by:
                                type: object
                                description: Information about the user who created the note
                                properties:
                                  fb_id:
                                    type: string
                                    description: Facebook ID
                                  fb_name:
                                    type: string
                                    description: Facebook name
                                  uid:
                                    type: string
                                    description: System user ID
                              edit_history:
                                type: array
                                description: History of edits
                                items:
                                  type: object
                              id:
                                type: string
                                description: Note ID
                              images:
                                type: array
                                description: List of images attached to the note
                                items:
                                  type: string
                              links:
                                type: array
                                description: List of links attached to the note
                                items:
                                  type: string
                              message:
                                type: string
                                description: Content of the note
                              order_id:
                                type: string
                                description: Related order ID
                              removed_at:
                                type: integer
                                format: int64
                                nullable: true
                                description: Time the note was removed (if applicable)
                              updated_at:
                                type: integer
                                format: int64
                                nullable: true
                                description: Time the note was last updated (if applicable)
                  success:
                    type: boolean
                    example: true

  /pages/{page_id}/page_customers/{page_customer_id}:
    put:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Customers
      summary: Update customer information
      description: >
        Update details of a specific customer on a page.  
        The customer ID can be obtained from the **Page customers** API.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: The ID of the page.
        - name: page_customer_id
          in: path
          required: true
          schema:
            type: UUID
          description: The ID of the customer to update.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: The page access token (can be created in the page settings or retrieved from the List Pages API).
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                changes:
                  type: object
                  description: Fields to update for the customer
                  properties:
                    gender:
                      type: string
                      enum: [male, female, unknown]
                      description: The customer's gender
                    birthday:
                      type: string
                      format: date
                      description: The customer's birthday in format YYYY-MM-DD
                    phone_numbers:
                      type: array
                      description: List of phone numbers
                      items:
                        type: string
                    name:
                      type: string
                      description: The customer's name
      responses:
        '200':
          description: Successfully updated the customer information
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

  /pages/{page_id}/page_customers/{page_customer_id}/notes:
    post:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Customers
      summary: Add a new customer note
      description: Add a new text note for a specific customer.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page
        - name: page_customer_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer (can be retrieved from API Page customers)
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  description: Note content (currently supports text only)
                  example: "This customer prefers afternoon calls."
      responses:
        '200':
          description: Successfully added a note
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

    put:
      tags:
        - Customers
      summary: Update a customer note
      description: Update an existing note for a specific customer.
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page
        - name: page_customer_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer (can be retrieved from API Page customers)
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                note_id:
                  type: string
                  description: ID of the note to update
                message:
                  type: string
                  description: Updated note content (currently supports text only)
                  example: "Updated note: prefers email communication."
      responses:
        '200':
          description: Successfully updated the note
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

    delete:
      tags:
        - Customers
      summary: Delete a customer note
      description: Delete an existing note for a specific customer.
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the page
        - name: page_customer_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer (can be retrieved from API Page customers)
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                note_id:
                  type: string
                  description: ID of the note to delete
      responses:
        '200':
          description: Successfully deleted the note
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true



  /pages/{page_id}/sip_call_logs:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Call logs
      summary: Retrieve call logs
      description: >
        Get the list of call history for a specific page.  
        Requires the page ID and access token.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: The ID of the page.
        - name: id
          in: query
          required: true
          schema:
            type: string
          description: The ID of the SIP package.
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: The page access token (can be created in the page settings).
        - name: page_number
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
          description: Current page number (minimum is 1).
        - name: page_size
          in: query
          required: true
          schema:
            type: integer
            maximum: 30
          description: Number of records per page (maximum is 30).
        - name: since
          in: query
          required: false
          schema:
            type: integer
            format: int64
          description: Start time (in Unix timestamp, seconds, UTC+0).
        - name: until
          in: query
          required: false
          schema:
            type: integer
            format: int64
          description: End time (in Unix timestamp, seconds, UTC+0).
      responses:
        '200':
          description: Successfully retrieved call logs
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        call_id:
                          type: string
                          description: The unique identifier for the call
                        caller:
                          type: string
                          description: The caller's phone number
                        callee:
                          type: string
                          description: The callee's phone number
                        start_time:
                          type: string
                          format: date-time
                          description: Start time of the call
                        duration:
                          type: integer
                          description: Duration of the call in seconds
                        status:
                          type: string
                          description: Call status (e.g., completed, missed)
                  success:
                    type: boolean
                    example: true

  /pages/{page_id}/tags:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Tags
      summary: Get list tags
      description: Retrieve a list of tags for a specific page.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer’s page
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      responses:
        '200':
          description: Successfully retrieved tags
          content:
            application/json:
              schema:
                type: object
                properties:
                  tags:
                    type: array
                    description: List of tags for the page
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          description: Unique ID of the tag
                          example: 0
                        text:
                          type: string
                          description: Name of the tag
                          example: "Kiểm hàng"
                        color:
                          type: string
                          description: Main color code of the tag
                          example: "#4b5577"
                        lighten_color:
                          type: string
                          description: Lightened color version
                          example: "#c9ccd6"

  /pages/{page_id}/posts:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Posts
      summary: Get posts
      description: Retrieve a list of posts for a specific page.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer’s page
        - name: since
          in: query
          required: true
          schema:
            type: integer
          description: Start time (Unix timestamp in seconds UTC+0)
        - name: until
          in: query
          required: true
          schema:
            type: integer
          description: End time (Unix timestamp in seconds UTC+0)
        - name: page_number
          in: query
          required: true
          schema:
            type: integer
          description: Current page number (minimum 1)
        - name: page_size
          in: query
          required: true
          schema:
            type: integer
          description: Page size (maximum 30)
        - name: page_access_token
          in: query
          required: true
          schema:
            type: string
          description: Page access token (can be created in the page settings)
        - name: type
          in: query
          required: false
          schema:
            type: string
            enum: [video, photo, text, livestream]
          description: Filter posts by type
      responses:
        '200':
          description: Successfully retrieved posts
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  total:
                    type: integer
                    description: Total number of posts
                    example: 200
                  posts:
                    type: array
                    description: List of posts
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: Unique ID of the post
                          example: "256469571178082_1719461745119729"
                        page_id:
                          type: string
                          description: ID of the page
                          example: "256469571178082"
                        from:
                          type: object
                          description: Post creator
                          properties:
                            id:
                              type: string
                              example: "5460527857372996"
                            name:
                              type: string
                              example: "Djamel Belkessa"
                        message:
                          type: string
                          description: Post content
                          example: "edit review là 1 nghệ thuật"
                        type:
                          type: string
                          description: Post type
                          example: "rating"
                        inserted_at:
                          type: string
                          format: date-time
                          description: Post creation timestamp
                          example: "2022-08-22T03:09:27"
                        comment_count:
                          type: integer
                          description: Number of comments
                          example: 0
                        reactions:
                          type: object
                          description: Post reactions
                          properties:
                            angry_count:
                              type: integer
                              description: Number of angry
                              example: 1
                            care_count: 
                              type: integer
                              description: Number of care
                              example: 2
                            haha_count:
                              type: integer
                              description: Number of haha
                              example: 1
                            like_count: 
                              type: integer
                              description: Number of like
                              example: 111
                            love_count: 
                              type: integer
                              description: Number of love
                              example: 14
                            sad_count:
                              type: integer
                              description: Number of sad
                              example: 12
                            wow_count: 
                              type: integer
                              description: Number of wow
                              example: 17
                        phone_number_count:
                          type: integer
                          description: Number of phone numbers in post
                          example: 0

#Users
  /pages/{page_id}/users:
    get:
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      tags:
        - Users
      summary: Get list of users
      description: Retrieve the list of users for a specific page.
      security:
        - PageAccessToken: []
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer’s page
        - name: page_access_token
          in: query
          required: false
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      responses:
        '200':
          description: Successfully retrieved user list
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  users:
                    type: array
                    description: Active users of the page
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: User UUID
                          example: "c4bafd84-7b96-4f28-b59a-031f17c32ddf"
                        name:
                          type: string
                          description: User name
                          example: "Anh Ngoc Nguyen"
                        status:
                          type: string
                          description: User availability status
                          example: "available"
                        fb_id:
                          type: string
                          description: Facebook ID of the user
                          example: "116256249766099"
                        page_permissions:
                          type: object
                          nullable: true
                          properties:
                            permissions:
                              type: array
                              items:
                                type: integer
                              example: [100, 71, 81]
                        status_in_page:
                          type: string
                          description: User’s status in the page
                          example: "active"
                        is_online:
                          type: boolean
                          description: Whether user is online
                          example: false
                  disabled_users:
                    type: array
                    description: List of disabled users
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: User UUID
                          example: "69586d78-dd37-4d25-ad2b-0716697b1c34"
                        name:
                          type: string
                          description: User name
                          example: "Khanh khanh"
                        fb_id:
                          type: string
                          description: Facebook ID of the user
                          example: "1736243166628197"
                  round_robin_users:
                    type: object
                    description: Users assigned for round robin
                    properties:
                      comment:
                        type: array
                        items:
                          type: string
                          description: User UUIDs for comments
                        example: ["79d4e769-ac31-4821-8304-d6e251d532e9"]
                      inbox:
                        type: array
                        items:
                          type: string
                          description: User UUIDs for inbox
                        example: ["fb5ff8ed-434b-4d4b-a213-b595b242b81a"]

  /pages/{page_id}/round_robin_users:
    post:
      tags:
        - Users
      summary: Update round robin users
      description: |
        Update the list of users assigned to the round robin system for message and comment handling.  
        To get the current list of selected users, use the `GET /pages/{page_id}/users` API, which returns the field `round_robin_users`.
      security:
        - PageAccessToken: []
      servers:
        - url: 'https://pages.fm/api/public_api/v1'
          description: Page's API v1
      parameters:
        - name: page_id
          in: path
          required: true
          schema:
            type: string
          description: ID of the customer’s page
        - name: page_access_token
          in: query
          required: false
          schema:
            type: string
          description: Page access token (can be created in the page settings)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                inbox:
                  type: array
                  description: List of user IDs selected for message assignments
                  items:
                    type: string
                  example: ["79d4e769-ac31-4821-8304-d6e251d532e9", "fb5ff8ed-434b-4d4b-a213-b595b242b81a"]
                comment:
                  type: array
                  description: List of user IDs selected for comment assignments
                  items:
                    type: string
                  example: ["79d4e769-ac31-4821-8304-d6e251d532e9"]
      responses:
        '200':
          description: Successfully updated round robin users
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Cài đặt đã được cập nhật thành công"
                  success:
                    type: boolean
                    example: true

#Page content
  /pages/{page_id}/upload_contents:
      post:
        summary: Upload media content
        tags:
          - Page's Contents
        description: >
          This endpoint allows uploading a file (e.g., image, video) to a Page.<br>
          The request must include a valid `page_access_token` in the query string.<br>


          Video size limit:<br>
            `Shopee`: maximum 30MB<br>
            `Whatsapp Official`: maximum 16MB<br>
            `Lazada`: maximum 100MB<br>
            `Other`: maximum 25MB

        security:
          - PageAccessToken: []
        servers:
          - url: 'https://pages.fm/api/public_api/v1'
            description: Page's API v1
        parameters:
          - name: page_id
            in: path
            required: true
            description: ID of the Page to upload the content to.
            schema:
              type: string
          - name: page_access_token
            in: query
            required: true
            description: Page Access Token obtained from **Settings → Tools**.
            schema:
              type: string
        requestBody:
          required: true
          content:
            multipart/form-data:
              schema:
                type: object
                properties:
                  file:
                    type: string
                    format: binary
                    description: The file to upload.
        responses:
          '200':
            description: Successful upload
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    id:
                      type: string
                      example: HXrxioWFIc5DFwffhmOVHspLuMwpWCXfWDoBxiov6DLa3MvakLeGpLQAly7oHDvZT66VEhnYG4zQEi2MhEzhlg
                    attachment_type:
                      description: Supported attachment types (PHOTO, VIDEO, DOCUMENT, AUDIO_ATTACHMENT_ID).
                      type: string
                      example: 'PHOTO'
                    success:
                      type: boolean
                      example: true
#Chat-plugin
  /pke_chat_plugin/messages:
    post:
      tags:
        - Chat Plugin
      servers:
        - url: 'https://pages.fm/api/v1'
      summary: Send message or create a new conversation
      description: |
        Send a message or create a new conversation to a customer through Pancake Chat Plugin.
        Supports text messages and attachments (e.g. images).
      parameters:
        - name: page_id
          in: query
          required: true
          description: Page ID of the chat plugin
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - from_id
                - dummy_id
                - inserted_at
              properties:
                message:
                  type: string
                  description: Text message content
                  example: Hello! How can I help you?
                dummy_id:
                  type: number
                  description: Client-side unique ID for tracking the message
                  example: 1765875902892
                extra_info:
                  type: object
                  description: Additional metadata
                  example: {}
                name:
                  type: string
                  description: Sender display name
                  example: Web_1619912441
                conversation_id:
                  type: string
                  description: Conversation ID. To create a new conversation you need set conversation_id is `null` 
                  example: web_1664524051101747_web_xxxxxxxxx
                from_id:
                  type: string
                  description: Sender ID
                  example: web_xxxxxxxxx
                replied_message_id:
                  type: string
                  nullable: true
                  description: ID of the message being replied to
                  example: null
                inserted_at:
                  type: number
                  description: Client timestamp in milliseconds
                  example: 1765875902892
                attachments:
                  type: array
                  description: List of attachments
                  items:
                    type: object
                    required:
                      - id
                      - name
                      - url
                      - type
                      - mime_type
                    properties:
                      id:
                        type: string
                        example: 1231231312_acac
                      name:
                        type: string
                        example: anh.png
                      url:
                        type: string
                        format: uri
                        example: https://cdn-icons-png.flaticon.com/512/9584/9584876.png
                      type:
                        type: string
                        description: Attachment type
                        example: photo
                      mime_type:
                        type: string
                        example: image/png
                      size:
                        type: number
                        description: File size in bytes
                        example: 33254
                      width:
                        type: number
                        description: Image width
                        example: 512
                      height:
                        type: number
                        description: Image height
                        example: 512
      responses:
        "200":
          description: Message sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: Message ID
                    example: web_1664524051101747_xxxxxxxxx
                  success:
                    type: boolean
                    example: true
                  conversation_id:
                    type: string
                    example: web_1664524051101747_web_xxxxxxxxx
                  from_id:
                    type: string
                    example: web_xxxxxxxxx
                  dummy_id:
                    type: number
                    example: 1765875902892  

    get:
      tags:
        - Chat Plugin
      servers:
        - url: 'https://pages.fm/api/v1'
      summary: Get messages of a conversation
      description: |
        Retrieve message history of a specific conversation in Pancake Chat Plugin.
        Supports pagination via offset.
      parameters:
        - name: conversation_id
          in: query
          required: true
          description: Conversation ID to fetch messages
          schema:
            type: string
            example: web_1664524051101747_web_xxxxxxxxx
        - name: page_id
          in: query
          required: true
          description: Page ID of the chat plugin
          schema:
            type: string
            example: web_1664524051101747
        - name: offset
          in: query
          required: false
          description: Offset for pagination
          schema:
            type: integer
            example: 0
      responses:
        "200":
          description: Messages retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  messages:
                    type: array
                    description: List of messages in the conversation
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          example: web_1664524051101747_xxxxxxxxx
                        message:
                          type: string
                          description: Message content (HTML format)
                          example: "<div>Hello</div>"
                        original_message:
                          type: string
                          description: Plain text message content
                          example: Hello
                        type:
                          type: string
                          description: Message type
                          example: INBOX
                        seen:
                          type: boolean
                          example: true
                        show_info:
                          type: boolean
                          example: true
                        from:
                          type: object
                          description: Sender information
                          properties:
                            id:
                              type: string
                              example: web_1664524051101747
                            name:
                              type: string
                              example: Pancake Team
                            admin_id:
                              type: string
                              nullable: true
                              example: web_1664524051101747
                            admin_name:
                              type: string
                              nullable: true
                              example: BotcakeAI
                        inserted_at:
                          type: string
                          format: date-time
                          example: "2025-12-13T04:59:23.856000"
                        page_id:
                          type: string
                          example: web_1664524051101747
                        conversation_id:
                          type: string
                          example: web_1664524051101747_web_xxxxxxxxx
                        attachments:
                          type: array
                          description: Attachments associated with the message
                          items:
                            type: object
                            properties:
                              type:
                                type: string
                                example: link
                              title:
                                type: string
                                example: Phụ kiện thời trang 07 | Webcake
                              description:
                                type: string
                                example: Phụ kiện thời trang 07 | Webcake
                              link:
                                type: string
                                format: uri
                                example: https://netfull.online/
                              image:
                                type: object
                                properties:
                                  url:
                                    type: string
                                    format: uri
                                    example: https://content.pancake.vn/xxx.png
                              is_web_source:
                                type: boolean
                                example: true
                        has_phone:
                          type: boolean
                          example: false
                        is_removed:
                          type: boolean
                          example: false
                        is_hidden:
                          type: boolean
                          example: false
                        message_tags:
                          type: array
                          items:
                            type: string
                        user_likes:
                          type: boolean
                          example: false
                  can_request_feedback:
                    type: boolean
                    description: Indicates whether feedback can be requested
                    example: true
components:
  securitySchemes:
    UserAccessToken:
      type: apiKey
      name: access_token
      in: query
      description: >
        User Access Token uniquely identifies an individual user.

        You can find this token in Pancake under: **Account → Personal Settings**.

        This token is valid for up to 90 days or until the user logs out.
        
        ![How to get User access token?](https://statics.pancake.vn/pancake-docs/2025/3/20/Screenshot%202025-03-20%20at%2014.20.51.png)

    PageAccessToken:
      type: apiKey
      name: page_access_token
      in: query
      description: >
        Page Access Token used to authenticate public APIs on behalf of a Page.

        The page's administer can retrieve this token from the Pancake interface by going to:
        **Settings → Tools** or call the Generate page_access_token API.

        This token does not expire unless it is manually deleted or renewed.

        ![How to get Page access token?](https://statics.pancake.vn/pancake-docs/2025/3/20/Screenshot%202025-03-20%20at%2014.30.53.png)

  schemas:
    Page:
      type: object
      properties:
        id:
          type: string
        platform:
          type: string
        name:
          type: string
        avatar_url:
          type: string
          format: uri

    Conversation:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          enum: [INBOX, COMMENT, LIVESTREAM]
        page_uid:
          type: string
        updated_at:
          type: string
          format: date-time
        inserted_at:
          type: string
          format: date-time
        tags:
          type: array
          items:
            type: string
        last_message:
          type: object
          properties:
            text:
              type: string
            sender:
              type: string
            created_at:
              type: string
              format: date-time
        participants:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              email:
                type: string
              phone:
                type: string
    Message:
      type: object
      description: Schema representing a single message within a conversation.
      properties:
        conversation_id:
          type: string
          description: ID of the conversation this message belongs to.
        from:
          type: object
          description: Information about the message sender.
          properties:
            email:
              type: string
              description: Sender's email address.
            id:
              type: string
              description: Unique identifier of the sender.
            name:
              type: string
              description: Sender's display name.
        has_phone:
          type: boolean
          description: Whether the sender has an associated phone number.
        inserted_at:
          type: string
          format: date-time
          description: Timestamp when the message was inserted.
        is_hidden:
          type: boolean
          description: Indicates if the message is hidden.
        is_removed:
          type: boolean
          description: Indicates if the message was removed.
        message:
          type: string
          description: Content of the message.
        page_id:
          type: string
          description: ID of the page associated with this message.
        type:
          type: string
          description: Message type (e.g., text, image, system).

    PrivateReply:
      title: Private Reply
      type: object
      required: [action, post_id, message_id, message]
      properties:
        action:
          type: string
          enum: [private_replies]
        post_id:
          type: string
          description: ID of the post containing the comment
        message_id:
          type: string
          description: ID of the comment you want to send message from
        from_id:
          type: string
          description: Unique identifier of the sender (from.id)
        message:
          type: string
          description: Content of the message
    InboxMessage:
      title: Inbox Message
      type: object
      required: [action, message]
      properties:
        action:
          type: string
          enum: [reply_inbox]
        message:
          type: string
          description: |
            **Text content of the inbox message**
            
            ⚠️ **MUTUALLY EXCLUSIVE with `content_ids`**: 
            - Use `message` for **text-only** messages
            - Use `content_ids` for **media/template** messages
            - **DO NOT send both** → API returns **500 error**
        content_ids:
          type: array
          description: List of content_ids you want to send. Content_id is generated from [the content upload API](https://developer.pancake.biz/#/paths/pages-page_id--upload_contents/post)
    ReplyComment:
      title: Reply Comment
      type: object
      required: [action, message_id, message]
      properties:
        action:
          type: string
          enum: [reply_comment]
        message_id:
          type: string
          description: ID of the comment you want to reply to
        message:
          type: string
          description: Content of the reply message
        content_ids:
          type: array
          description: List of content_ids you want to send. Content_id is generated from [the content upload API](https://developer.pancake.biz/#/paths/pages-page_id--upload_contents/post)
        mentions:
          type: array
          items:
            type: object
            properties:
              psid:
                type: string
                description: Customer's PSID
              name:
                type: string
                description: Customer's name
              offset:
                type: integer
              length:
                type: integer