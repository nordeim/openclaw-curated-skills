# Prompt Injection Patterns
# Risk: HIGH (70-90)
# NOTE: Patterns designed to minimize false positives

patterns:
  - name: ignore_previous_instructions
    regex: "(?i)ignore\\s+(all\\s+)?(previous|prior|above)\\s+instructions"
    risk: 95
    description: "Classic prompt injection: ignore previous instructions"
    
  - name: forget_instructions
    regex: "(?i)forget\\s+(everything|all|your)\\s+(about|instructions|rules)"
    risk: 90
    description: "Prompt injection: forget instructions"
    
  - name: new_system_prompt
    regex: "(?i)new\\s+system\\s+(prompt|instruction|message)"
    risk: 90
    description: "Attempting to set new system prompt"
    
  - name: system_override
    regex: "(?i)system\\s*override"
    risk: 95
    description: "System override attempt"
    
  - name: dan_jailbreak
    regex: "(?i)\\bDAN\\b|\\bjailbreak\\b|\\bdeveloper\\s*mode\\b"
    risk: 85
    description: "Known jailbreak keywords (DAN, jailbreak)"
    
  - name: you_are_now
    regex: "(?i)you\\s+are\\s+now\\s+(a|an|in|my)"
    risk: 75
    description: "Identity manipulation: you are now..."
    
  - name: pretend_no_restrictions
    regex: "(?i)pretend\\s+(you\\s+)?(have\\s+)?no\\s+(restrictions|limits|rules)"
    risk: 85
    description: "Pretend no restrictions"
    
  - name: admin_override
    regex: "(?i)(admin|root|superuser)\\s+(mode|override|access)"
    risk: 90
    description: "Admin/root override attempt"
    
  - name: hidden_html_instruction
    regex: "<!--[^>]*?(ignore|override|forget|new instruction)[^>]*?-->"
    risk: 80
    description: "Hidden instructions in HTML comments"
