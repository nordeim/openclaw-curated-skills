# Obfuscation & Credential Theft Patterns
# Risk: MEDIUM-HIGH (50-85)

patterns:
  - name: ssh_key_access
    regex: "\\.ssh/(id_rsa|id_ed25519|id_ecdsa|config|known_hosts)"
    risk: 90
    description: "SSH key file access"
    
  - name: aws_credentials
    regex: "\\.aws/(credentials|config)"
    risk: 90
    description: "AWS credentials access"
    
  - name: env_file_read
    regex: "(open|read|cat|source).*\\.env"
    risk: 75
    description: ".env file access"
    
  - name: api_key_hardcoded
    regex: "(api[_-]?key|apikey|secret[_-]?key|access[_-]?token)\\s*[=:]\\s*[\"'][^\"']{20,}"
    risk: 70
    description: "Hardcoded API key pattern"
    
  - name: password_hardcoded
    regex: "(password|passwd|pwd)\\s*[=:]\\s*[\"'][^\"']{8,}"
    risk: 80
    description: "Hardcoded password pattern"
    
  - name: gcp_credentials
    regex: "\\.config/gcloud"
    risk: 85
    description: "GCP credentials access"
    
  - name: kube_config
    regex: "\\.kube/config"
    risk: 85
    description: "Kubernetes config access"
    
  - name: long_base64
    regex: "[A-Za-z0-9+/=]{100,}"
    risk: 60
    description: "Long base64-like string (potential encoded payload)"
    
  - name: hex_string
    regex: "(\\\\x[0-9a-fA-F]{2}){10,}"
    risk: 65
    description: "Long hex-encoded string"
    
  - name: char_code_array
    regex: "String\\.fromCharCode\\s*\\(.*,.*,.*\\)"
    risk: 70
    description: "JavaScript char code obfuscation"
    
  - name: marshal_loads
    regex: "marshal\\.loads?"
    risk: 75
    description: "Python marshal (code object loading)"
    
  - name: pickle_loads
    regex: "pickle\\.loads?"
    risk: 80
    description: "Pickle deserialization (dangerous)"
    
  - name: pty_import
    regex: "import\\s+pty|from\\s+pty"
    risk: 70
    description: "pty import (often used in shells)"
